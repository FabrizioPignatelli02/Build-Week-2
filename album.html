<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spotify</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="./assets/css/circular-font.css" />
    <link rel="stylesheet" href="./assets/css/style.css" />
  </head>
  <body class>
    <div class="container-fluid">
      <div class="row">
        <nav id="sidebar-left" class="d-none d-xl-block col-md-2 bg-black text-white pe-0">
          <div class="btn-group">
            <button
              class="btn btn-black text-white btn-sm"
              type="button"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <i class="bi bi-three-dots"></i>
            </button>
            <ul class="dropdown-menu"></ul>
          </div>
          <div id="icon-navbar">
            <ul class="navbar-nav mt-2">
              <li class="nav-item">
                <a href="./index.html"><i class="bi bi-house-door-fill me-2"></i> Homepage</a>
              </li>
              <li class="nav-item">
                <a href="#"><i class="bi bi-search me-2"></i> Cerca</a>
              </li>
              <li class="nav-item">
                <a href="#"><i class="bi bi-list me-2"></i> La tua libreria</a>
              </li>
            </ul>
          </div>
          <div id="myfunction" class="mt-3 border-bottom border-secondary">
            <ul class="properties px-0 py-2">
              <li class="item-function">
                <a href="#"><i class="bi bi-plus-square me-2"></i> Crea Playlist</a>
              </li>
              <li class="item-function">
                <a href="#"><i class="bi bi-heart-fill me-2"></i>Brani che ti piacciono</a>
              </li>
              <li class="item-function">
                <a href="#"><i class="bi bi-bookmark me-2"></i>I tuoi episodi</a>
              </li>
            </ul>
          </div>
          <div id="playlistGroup" class="d-none d-xl-block">
            <ul class="px-0">
              <li><a href="#">Gym songs</a></li>
              <li><a href="#">EDM House</a></li>
              <li><a href="#">Italian Pop</a></li>
              <li><a href="#">Relax Beat</a></li>
              <li><a href="#">Concentrazione massima</a></li>
              <li><a href="#">By the piano</a></li>
              <li><a href="#">Verso il cielo</a></li>
              <li><a href="#">This is Il Tre</a></li>
              <li><a href="#">Christmas Songs</a></li>
              <li><a href="#">Radio Alan Walker</a></li>
              <li><a href="#">Indie italiano</a></li>
              <li><a href="#">Summer Vibes</a></li>
              <li><a href="#">Classic 99/00</a></li>
              <li><a href="#">Love you</a></li>
              <li><a href="#">Che fai qua</a></li>
            </ul>
          </div>
        </nav>

        <main id="content" class="col-md-7 scrollable">
          <a id="back" href="javascript:history.back()" class="BB btn-B"><i class="bi bi-chevron-left"></i></a>
          <a id="next" href="#" class="BB btn-N"><i class="bi bi-chevron-right"></i></a>
          <section id="thisAlbum">
            <div class="containerAlbum">
              <div class="card d-flex flex-row mainAlbum"></div>
            </div>
            <div class="listContainer">
              <div class="Icons"></div>
              <div class="list">
                <div class="table-responsive">
                  <table class="table"></table>
                </div>
              </div>
            </div>
          </section>
        </main>
        <aside id="sidebar-right" class="col-md-3 bg-black text-white">
          <div class="d-flex justify-content-between mb-3">
            <h5>Attivit√† amici</h5>
            <div>
              <a href="#"><i class="bi bi-person-plus"></i></a>
              <a href="#"><i class="bi bi-x"></i></a>
            </div>
          </div>
          <div id="cardFriends">
            <div class="row align-items-center">
              <div class="col-md-4 pb-5">
                <img src="./assets/imgs/search/image-3.jpg" class="img-fluid rounded-circle" width="75px" alt="..." />
              </div>
              <div class="col-md-8">
                <div class="card-body mb-3">
                  <div class="d-flex justify-content-between">
                    <h5 class="card-title">Charlie Hookman</h5>
                    <p class="small">4 ore</p>
                  </div>
                  <p class="card-text small">In Camera <i class="bi bi-dot"></i> Yumi Zouma</p>
                  <p><i class="bi bi-stop-circle"></i> EP III</p>
                </div>
              </div>
              <div class="col-md-4 pb-5">
                <img src="./assets/imgs/search/image-3.jpg" class="img-fluid rounded-circle" width="75px" alt="..." />
              </div>
              <div class="col-md-8">
                <div class="card-body mb-3">
                  <div class="d-flex justify-content-between">
                    <h5 class="card-title">LightDark02</h5>
                    <p class="small">8 ore</p>
                  </div>
                  <p class="card-text small">Aimed To Kill <i class="bi bi-dot"></i> Jade LeMac</p>
                  <p><i class="bi bi-stop-circle"></i> Aimed To Kill</p>
                </div>
              </div>
              <div class="col-md-4 pb-5">
                <img src="./assets/imgs/search/image-3.jpg" class="img-fluid rounded-circle" width="75px" alt="..." />
              </div>
              <div class="col-md-8">
                <div class="card-body mb-3">
                  <div class="d-flex justify-content-between">
                    <h5 class="card-title">Valeria Traverso</h5>
                    <p class="small">3 giorni</p>
                  </div>
                  <p class="card-text small">New Kings <i class="bi bi-dot"></i> Sleeping Wall</p>
                  <p><i class="bi bi-music-note-beamed"></i> Twint Badass Mood</p>
                </div>
              </div>
            </div>
          </div>
        </aside>
      </div>
    </div>

    <footer class="d-flex sticky-lg-bottom justify-content-between bg-dark text-white">
      <div>1</div>
      <div>2</div>
      <div>3</div>
    </footer>
    <div class="bg-black sticky-bottom d-block d-lg-none p-0">
      <nav class="navbar">
        <div class="container-fluid justify-content-around">
          <div id="icon-navbar">
            <a href="./index.html"><i class="bi bi-house-door-fill me-2 fs-1"></i></a>
          </div>
          <div id="icon-navbar" class="d-flex">
            <a href="#"><i class="bi bi-search me-2 fs-1"></i></a>
          </div>
          <div id="icon-navbar" class="d-flex">
            <a href="#"><i class="bi bi-list me-2 fs-1"></i></a>
          </div>
        </div>
      </nav>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const id = urlParams.get("id");
      const container = document.querySelector(".card");
      const table = document.querySelector(".table");
      fetch("https://deezerdevs-deezer.p.rapidapi.com/playlist/" + id, {
        method: "GET",
        headers: {
          "X-RapidAPI-Key": "340f0fd2c3mshd061c26435823fbp17f559jsnc5395de2b6ca",
          "X-RapidAPI-Host": "deezerdevs-deezer.p.rapidapi.com",
        },
      })
        .then((resp) => {
          if (!resp.ok) {
            throw new Error(`HTTP error! Status: ${resp.status}`);
          }
          return resp.json();
        })
        .then((albumObj) => {
          console.log(albumObj);
          const year = new Date(albumObj.creation_date).getFullYear();
          const hours = Math.floor(albumObj.duration / 3600);
          const minutes = Math.floor((albumObj.duration % 3600) / 60);

          container.innerHTML = `
        <img class="card-img" src="${albumObj.picture_medium}" alt="${albumObj.title}">
                <div class="card-body">
                  <span>album</span>
                  <h4 class="card-title">${albumObj.title}</h4>
                  <p class="card-text"><img class="imgSmall" src="${albumObj.picture_small}">${albumObj.creator.name} <span class="anno">${year}</span> ${albumObj.nb_tracks} brani,<span class="time">${hours} ora e ${minutes} minuti</span></p>
                </div>
              </div>            
        `;
          table.innerHTML = `
              <thead>
                <tr>
                  <th scope="col"># TITOLO</th>
                  <th scope="col">RIPRODUZIONI</th>
                  <th scope="col"><i class="bi bi-clock"></i></th>
                </tr>
              </thead>
              <tbody>
                ${albumObj.tracks.data
                  .map((element, index) => {
                    const minutes = Math.floor(element.duration / 60);
                    const seconds = element.duration % 60;
                    const formattedDuration = `${minutes}:${String(seconds).padStart(2, "0")}`;

                    return `
                    <tr class="nameList">
                      <td scope="row" class="name d-flex">
                        <span class="index">${index + 1}</span>
                        <div>
                          <p>${element.title}</p>
                          <span class="artist">${element.artist.name}</span>
                        </div>
                      </td>
                      <td>${element.rank}</td>
                      <td>${formattedDuration}</td>
                    </tr>
                  `;
                  })
                  .join("")}
              </tbody>
            `;
        })
        .catch((err) => console.error("Error:", err));
    </script>
  </body>
</html>
